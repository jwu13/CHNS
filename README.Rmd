---
output: github_document
---


<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# CHNS R package <img src='data-raw/hex.png' align="right" height="139"/>

<!-- badges: start -->

[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/surveyjanitor)](https://CRAN.R-project.org/package=surveyjanitor)
[![R-CMD-check](https://github.com/jwu13/CHNS/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/jwu13/CHNS/actions/workflows/R-CMD-check.yaml)

<!-- badges: end -->


## Summary

Our package helps researchers explore [China Health and Nutrition Survey](https://www.cpc.unc.edu/projects/china/data) With just a basic knowledge of R, the users can access a wide variety of information regarding effects of the health, nutrition, and family planning policies on the health and nutritional status of its population. \

The package includes two data set that includes individual-level survey data of 10 specific years over the period of 1989 - 2015.\

There are currently three functions inside the package:\

- `real_income`: takes in a numeric year value and returns a data frame with real income adjusted for inflation.\

- `num_of_children`: takes in a numeric year value and returns a data frame with child births, child deaths, and total children up to the input year.\

- `map_income`: takes in a numeric year value and returns a map of China with province-level average annual income mapped on the surveyed provinces.\

This package would be a useful tool for social science researchers interested in policy analysis in China. Additionally, it is also an easy tool for data analysis and visualization for anyone interested in CHNS.


## Installation

You can install the development version of CHNS from [Github] (https://github.com/jwu13/CHNS) with:

```{r}
# install.packages("devtools")
devtools::install_github("jwu13/CHNS")
```

You can load this package by
```{r}
library(chns)
```

For `map_income()` function in the package, you also need to install and load the package leafletCN.
```{r, eval=FALSE}
install.packages("leafletCN")
library(leafletCN)
```

## Data Sets Included

- `indinc_10_clean`: A data set that includes 88166 survey data entries from 1989 - 2015 with Individual ID, survey year, and nominal individual income.
- `emw_12_clean`: A data set that includes 26616 survey data entries from 1989 - 2015 with Individual ID, survey year, number of child died and number of child births for women.
- `map_dat_clean`: A simple data set with province-level average annual income, survey year, province names in both English and Chinese, and categories of income that is used for mapping.

## Example 1: Get Real Income with selected base year.

This is a basic example for `real_income()` that returns a tibble with income weighted over inflation for the selected base year.
```{r}
real_income(base_year=1989) 
```

## Example 2: Get Number of Children a women has up to an inputted year.

```{r}
num_of_children(year = 2006) 
```

### Data Visualization

- Example 3: Get a map to get an overview of province-level average income.

![a visualization demo](data-raw/viz_demo.png)
```{r message=FALSE, warning=FALSE, eval=FALSE}
map_income(year = 2011)
```

## Project Proposal

We would like to build an R package that makes importing data, tidying data and data analysis more user friendly for social science data sets, specifically, we'll be creating the following functions for The China Health and Nutrition Survey (CHNS) data. CHNS contains panel data over two decades and we would like to reduce repetitive data-tidying work for researchers.

We will be creating the following functions for this project, serving both data wrangling and data visualization purposes on CHNS data.

### Data Wrangling:
1) `real_income(base_year)`: This function calculates the deflated/inflated real income based on the selected survey year. 

2) `num_of_children(base_year)`: This function returns the number of children a woman had up to an inputted year. 

### Data Visualization:
3) `map_income(year)`: This function would potentially map the average income by province on the map for the selected year.


## Group Members 

- Junru Wu
- Betty Pu



